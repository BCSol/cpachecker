/* Generated by CIL v. 1.3.6 */
/* print_CIL_Input is true */

void errorFn(void) ;
void _BLAST_init(void) ;
void stub_driver_init(void) ;
int KbFilter_PnP(int DeviceObject , int Irp ) ;
void stubMoreProcessingRequired(void) ;
int IofCallDriver(int DeviceObject , int Irp ) ;
void IofCompleteRequest(int Irp , int PriorityBoost ) ;
int KeSetEvent(int Event , int Increment , int Wait ) ;
int KeWaitForSingleObject(int Object , int WaitReason , int WaitMode , int Alertable ,
                          int Timeout ) ;
int KbFilter_Complete(int DeviceObject , int Irp , int Context ) ;
int KernelMode  ;
int Executive  ;
void errorFn(void) 
{ 

  {
  goto ERROR;
  ERROR: 
  return;
}
}
int s  ;
int UNLOADED  ;
int NP  ;
int DC  ;
int SKIP1  ;
int SKIP2  ;
int MPR1  ;
int MPR3  ;
int IPC  ;
int pended  ;
int compFptr  ;
int compRegistered  ;
int lowerDriverReturn  ;
int setEventCalled  ;
int customIrp  ;
int myStatus  ;
void stub_driver_init(void) 
{ 

  {
  s = NP;
  pended = 0;
  compFptr = 0;
  compRegistered = 0;
  lowerDriverReturn = 0;
  setEventCalled = 0;
  customIrp = 0;
  return;
}
}
void _BLAST_init(void) 
{ 

  {
  UNLOADED = 0;
  NP = 1;
  DC = 2;
  SKIP1 = 3;
  SKIP2 = 4;
  MPR1 = 5;
  MPR3 = 6;
  IPC = 7;
  s = UNLOADED;
  pended = 0;
  compFptr = 0;
  compRegistered = 0;
  lowerDriverReturn = 0;
  setEventCalled = 0;
  customIrp = 0;
  return;
}
}
int KbFilter_PnP(int DeviceObject , int Irp ) 
{ int devExt ;
  int irpStack ;
  int status ;
  int event ;
  int DeviceObject__DeviceExtension ;
  int Irp__Tail__Overlay__CurrentStackLocation ;
  int irpStack__MinorFunction ;
  int devExt__TopOfStack ;
  int devExt__Started ;
  int devExt__Removed ;
  int devExt__SurpriseRemoved ;
  int Irp__IoStatus__Status ;
  int Irp__IoStatus__Information ;
  int Irp__CurrentLocation ;
  int irpSp ;
  int nextIrpSp ;
  int nextIrpSp__Control ;
  int irpSp___0 ;
  int irpSp__Context ;
  int irpSp__Control ;

  {
  status = 0;
  devExt = DeviceObject__DeviceExtension;
  irpStack = Irp__Tail__Overlay__CurrentStackLocation;
  if (irpStack__MinorFunction == 0) {
    goto switch_0_0;
  } else {
    if (irpStack__MinorFunction == 23) {
      goto switch_0_23;
    } else {
      if (irpStack__MinorFunction == 2) {
        goto switch_0_2;
      } else {
        if (irpStack__MinorFunction == 1) {
          goto switch_0_1;
        } else {
          if (irpStack__MinorFunction == 5) {
            goto switch_0_1;
          } else {
            if (irpStack__MinorFunction == 3) {
              goto switch_0_1;
            } else {
              if (irpStack__MinorFunction == 6) {
                goto switch_0_1;
              } else {
                if (irpStack__MinorFunction == 13) {
                  goto switch_0_1;
                } else {
                  if (irpStack__MinorFunction == 4) {
                    goto switch_0_1;
                  } else {
                    if (irpStack__MinorFunction == 7) {
                      goto switch_0_1;
                    } else {
                      if (irpStack__MinorFunction == 8) {
                        goto switch_0_1;
                      } else {
                        if (irpStack__MinorFunction == 9) {
                          goto switch_0_1;
                        } else {
                          if (irpStack__MinorFunction == 12) {
                            goto switch_0_1;
                          } else {
                            if (irpStack__MinorFunction == 10) {
                              goto switch_0_1;
                            } else {
                              if (irpStack__MinorFunction == 11) {
                                goto switch_0_1;
                              } else {
                                if (irpStack__MinorFunction == 15) {
                                  goto switch_0_1;
                                } else {
                                  if (irpStack__MinorFunction == 16) {
                                    goto switch_0_1;
                                  } else {
                                    if (irpStack__MinorFunction == 17) {
                                      goto switch_0_1;
                                    } else {
                                      if (irpStack__MinorFunction == 18) {
                                        goto switch_0_1;
                                      } else {
                                        if (irpStack__MinorFunction == 19) {
                                          goto switch_0_1;
                                        } else {
                                          if (irpStack__MinorFunction == 20) {
                                            goto switch_0_1;
                                          } else {
                                            {
                                            goto switch_0_1;
                                            if (0) {
                                              switch_0_0: /* CIL Label */ 
                                              irpSp = Irp__Tail__Overlay__CurrentStackLocation;
                                              nextIrpSp = Irp__Tail__Overlay__CurrentStackLocation - 1;
                                              nextIrpSp__Control = 0;
                                              if (s != NP) {
                                                {
                                                errorFn();
                                                }
                                              } else {
                                                if (compRegistered != 0) {
                                                  {
                                                  errorFn();
                                                  }
                                                } else {
                                                  compRegistered = 1;
                                                }
                                              }
                                              {
                                              irpSp___0 = Irp__Tail__Overlay__CurrentStackLocation - 1;
                                              irpSp__Context = event;
                                              irpSp__Control = 0;
                                              irpSp__Control = 64;
                                              irpSp__Control |= 128;
                                              irpSp__Control |= 32;
                                              status = IofCallDriver(devExt__TopOfStack,
                                                                     Irp);
                                              }
                                              if (259L == (long )status) {
                                                {
                                                KeWaitForSingleObject(event, Executive,
                                                                      KernelMode,
                                                                      0, 0);
                                                }
                                              } else {

                                              }
                                              if (status >= 0) {
                                                if (myStatus >= 0) {
                                                  devExt__Started = 1;
                                                  devExt__Removed = 0;
                                                  devExt__SurpriseRemoved = 0;
                                                } else {

                                                }
                                              } else {

                                              }
                                              {
                                              Irp__IoStatus__Status = status;
                                              myStatus = status;
                                              Irp__IoStatus__Information = 0;
                                              IofCompleteRequest(Irp, 0);
                                              }
                                              goto switch_0_break;
                                              switch_0_23: /* CIL Label */ 
                                              devExt__SurpriseRemoved = 1;
                                              if (s == NP) {
                                                s = SKIP1;
                                              } else {
                                                {
                                                errorFn();
                                                }
                                              }
                                              {
                                              Irp__CurrentLocation += 1;
                                              Irp__Tail__Overlay__CurrentStackLocation += 1;
                                              status = IofCallDriver(devExt__TopOfStack,
                                                                     Irp);
                                              }
                                              goto switch_0_break;
                                              switch_0_2: /* CIL Label */ 
                                              devExt__Removed = 1;
                                              if (s == NP) {
                                                s = SKIP1;
                                              } else {
                                                {
                                                errorFn();
                                                }
                                              }
                                              {
                                              Irp__CurrentLocation += 1;
                                              Irp__Tail__Overlay__CurrentStackLocation += 1;
                                              IofCallDriver(devExt__TopOfStack, Irp);
                                              status = 0L;
                                              }
                                              goto switch_0_break;
                                              switch_0_1: /* CIL Label */ 
                                              switch_0_5: /* CIL Label */ 
                                              switch_0_3: /* CIL Label */ 
                                              switch_0_6: /* CIL Label */ 
                                              switch_0_13: /* CIL Label */ 
                                              switch_0_4: /* CIL Label */ 
                                              switch_0_7: /* CIL Label */ 
                                              switch_0_8: /* CIL Label */ 
                                              switch_0_9: /* CIL Label */ 
                                              switch_0_12: /* CIL Label */ 
                                              switch_0_10: /* CIL Label */ 
                                              switch_0_11: /* CIL Label */ 
                                              switch_0_15: /* CIL Label */ 
                                              switch_0_16: /* CIL Label */ 
                                              switch_0_17: /* CIL Label */ 
                                              switch_0_18: /* CIL Label */ 
                                              switch_0_19: /* CIL Label */ 
                                              switch_0_20: /* CIL Label */ 
                                              switch_0_default: /* CIL Label */ ;
                                              if (s == NP) {
                                                s = SKIP1;
                                              } else {
                                                {
                                                errorFn();
                                                }
                                              }
                                              {
                                              Irp__CurrentLocation += 1;
                                              Irp__Tail__Overlay__CurrentStackLocation += 1;
                                              status = IofCallDriver(devExt__TopOfStack,
                                                                     Irp);
                                              }
                                              goto switch_0_break;
                                            } else {
                                              switch_0_break: /* CIL Label */ ;
                                            }
                                            }
                                          }
                                        }
                                      }
                                    }
                                  }
                                }
                              }
                            }
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  }
  return (status);
}
}
int main(void) 
{ int status ;
  int irp ;
  int pirp ;
  int pirp__IoStatus__Status ;
  int __BLAST_NONDET ;
  int irp_choice ;
  int devobj ;

  {
  {
  status = 0;
  pirp = irp;
  _BLAST_init();
  }
  if (status >= 0) {
    s = NP;
    customIrp = 0;
    setEventCalled = customIrp;
    lowerDriverReturn = setEventCalled;
    compRegistered = lowerDriverReturn;
    pended = compRegistered;
    pirp__IoStatus__Status = 0L;
    myStatus = 0L;
    if (irp_choice == 0) {
      pirp__IoStatus__Status = 3221225659LL;
      myStatus = 3221225659LL;
    } else {

    }
    {
    stub_driver_init();
    }
    if (! (status >= 0)) {
      return (-1);
    } else {

    }
    if (__BLAST_NONDET == 3) {
      goto switch_1_3;
    } else {
      {
      goto switch_1_default;
      if (0) {
        switch_1_3: /* CIL Label */ 
        {
        status = KbFilter_PnP(devobj, pirp);
        }
        goto switch_1_break;
        switch_1_default: /* CIL Label */ ;
        return (-1);
      } else {
        switch_1_break: /* CIL Label */ ;
      }
      }
    }
  } else {

  }
  if (pended == 1) {
    if (s == NP) {
      s = NP;
    } else {
      goto _L___2;
    }
  } else {
    _L___2: /* CIL Label */ 
    if (pended == 1) {
      if (s == MPR3) {
        s = MPR3;
      } else {
        goto _L___1;
      }
    } else {
      _L___1: /* CIL Label */ 
      if (s == UNLOADED) {

      } else {
        if (status == -1) {

        } else {
          if (s != SKIP2) {
            if (s != IPC) {
              if (s != DC) {

              } else {
                goto _L___0;
              }
            } else {
              goto _L___0;
            }
          } else {
            _L___0: /* CIL Label */ 
            if (pended == 1) {
              if (status != 259) {
                {
                errorFn();
                }
              } else {

              }
            } else {
              if (s == DC) {
                if (status == 259) {

                } else {

                }
              } else {
                if (status != lowerDriverReturn) {

                } else {

                }
              }
            }
          }
        }
      }
    }
  }
  return (status);
}
}
void stubMoreProcessingRequired(void) 
{ 

  {
  if (s == NP) {
    s = MPR1;
  } else {
    {
    errorFn();
    }
  }
  return;
}
}
int IofCallDriver(int DeviceObject , int Irp ) 
{ int __BLAST_NONDET ;
  int returnVal2 ;
  int compRetStatus ;
  int lcontext ;

  {
  if (compRegistered) {
    {
    compRetStatus = KbFilter_Complete(DeviceObject, Irp, lcontext);
    }
    if ((long long )compRetStatus == 3221225494LL) {
      {
      stubMoreProcessingRequired();
      }
    } else {

    }
  } else {

  }
  if (__BLAST_NONDET == 0) {
    goto switch_2_0;
  } else {
    if (__BLAST_NONDET == 1) {
      goto switch_2_1;
    } else {
      {
      goto switch_2_default;
      if (0) {
        switch_2_0: /* CIL Label */ 
        returnVal2 = 0L;
        goto switch_2_break;
        switch_2_1: /* CIL Label */ 
        returnVal2 = 3221225473LL;
        goto switch_2_break;
        switch_2_default: /* CIL Label */ 
        returnVal2 = 259L;
        goto switch_2_break;
      } else {
        switch_2_break: /* CIL Label */ ;
      }
      }
    }
  }
  if (s == NP) {
    s = IPC;
    lowerDriverReturn = returnVal2;
  } else {
    if (s == MPR1) {
      if (returnVal2 == 259) {
        s = MPR3;
        lowerDriverReturn = returnVal2;
      } else {
        s = NP;
        lowerDriverReturn = returnVal2;
      }
    } else {
      if (s == SKIP1) {
        s = SKIP2;
        lowerDriverReturn = returnVal2;
      } else {
        {
        errorFn();
        }
      }
    }
  }
  return (returnVal2);
}
}
void IofCompleteRequest(int Irp , int PriorityBoost ) 
{ 

  {
  if (s == NP) {
    s = DC;
  } else {
    {
    errorFn();
    }
  }
  return;
}
}
int KeSetEvent(int Event , int Increment , int Wait ) 
{ int l ;

  {
  setEventCalled = 1;
  return (l);
}
}
int KeWaitForSingleObject(int Object , int WaitReason , int WaitMode , int Alertable ,
                          int Timeout ) 
{ int __BLAST_NONDET ;

  {
  if (s == MPR3) {
    if (setEventCalled == 1) {
      s = NP;
      setEventCalled = 0;
    } else {
      goto _L;
    }
  } else {
    _L: /* CIL Label */ 
    if (customIrp == 1) {
      s = NP;
      customIrp = 0;
    } else {
      if (s == MPR3) {
        {
        errorFn();
        }
      } else {

      }
    }
  }
  if (__BLAST_NONDET == 0) {
    goto switch_3_0;
  } else {
    {
    goto switch_3_default;
    if (0) {
      switch_3_0: /* CIL Label */ 
      return (0L);
      switch_3_default: /* CIL Label */ ;
      return (3221225473LL);
    } else {
      switch_3_break: /* CIL Label */ ;
    }
    }
  }
}
}
int KbFilter_Complete(int DeviceObject , int Irp , int Context ) 
{ int event ;

  {
  {
  event = Context;
  KeSetEvent(event, 0, 0);
  }
  return (3221225494LL);
}
}
