// this is a ObserverAutomaton copy of the simple_setuid.spc.txt of Blast
// the last event was not copied

AUTOMATON simple_setuid
LOCAL int uid = 0;
INITIAL STATE Init;

STATE Init : 
  MATCH { $? = system($?); } -> ASSERT !(uid == 0) GOTO Init;
  MATCH { system($?); } -> ASSERT !(uid == 0) GOTO Init;
  
  MATCH { $? = setuid($1); } -> DO uid=$1 GOTO Init;
  MATCH { setuid($1); } -> DO uid=$1 GOTO Init;
  
  TRUE -> GOTO Init;